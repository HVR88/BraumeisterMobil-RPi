{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block head %}

{{ super() }}
{% endblock %}
{% block content %}
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <title>BMPi</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
    <table class="screen">
        <tbody>
            <tr></tr>
        </tbody>
    </table>
    <table class="buttons">
        <tbody>
            <tr>
                <td style="width:25%; text-align:center;">
                    <img alt="?" height="70" width="70" src="/button.bmp"><br>
                </td>
                <td style="width:25%; text-align:center;">
                    <img alt="?" height="70" width="70" src="/button.bmp"><br>
                </td>
                    <td style="width:25%; text-align:center;">
                    <img alt="?" height="70" width="70" src="/button.bmp"><br>
                </td>
                    <td style="width:25%; text-align:center;">
                    <img alt="?" height="70" width="70" src="/button.bmp"><br>
                </td>
            </tr>
        </tbody>
    </table>
        <script>
            var tempContainer = document.getElementById("temp");
            var ipContainer = document.getElementById("ipaddr");

            const eventSource = new EventSource("/stream");
            eventSource.onmessage = function(e) {
                console.log(e.data)
                const obj = JSON.parse(e.data);
                if(typeof obj.target_temp !== 'undefined')
                    tempContainer.innerHTML = obj.target_temp + '<br>';

                if(typeof obj.ipaddr !== 'undefined')
                    ipContainer.innerHTML = obj.ipaddr + '<br>';
            };
            eventSource.onerror = function(err) {
                console.error('EventSource failed:', err);
            };    
        </script>

{% endblock %}
